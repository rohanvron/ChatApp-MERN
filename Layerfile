FROM webapp.io/node

# Set the working directory to /app
WORKDIR /app

# Copy the whole project to the container
COPY . .

# Install backend dependencies
RUN npm install

# Install frontend dependencies and build the frontend
RUN npm install --prefix frontend
RUN npm run build --prefix frontend

# Move the frontend build files to the backend's public directory
RUN mkdir -p backend/public
RUN cp -r frontend/dist/* backend/public/

RUN BACKGROUND npm start
EXPOSE WEBSITE http://localhost:8000